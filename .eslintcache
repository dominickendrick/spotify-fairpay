[{"/Users/dominic_kendrick/code/spotify-fairpay/src/reportWebVitals.js":"1","/Users/dominic_kendrick/code/spotify-fairpay/src/index.js":"2","/Users/dominic_kendrick/code/spotify-fairpay/src/spotify/api.ts":"3","/Users/dominic_kendrick/code/spotify-fairpay/src/App.tsx":"4","/Users/dominic_kendrick/code/spotify-fairpay/src/spotify/utils.ts":"5","/Users/dominic_kendrick/code/spotify-fairpay/src/spotify/ArtistChart.tsx":"6","/Users/dominic_kendrick/code/spotify-fairpay/src/spotify/ArtistLists.tsx":"7","/Users/dominic_kendrick/code/spotify-fairpay/src/spotify/ArtistsData.tsx":"8"},{"size":362,"mtime":1609239339939,"results":"9","hashOfConfig":"10"},{"size":500,"mtime":1609239339938,"results":"11","hashOfConfig":"10"},{"size":2446,"mtime":1609608633412,"results":"12","hashOfConfig":"10"},{"size":1826,"mtime":1609609788634,"results":"13","hashOfConfig":"10"},{"size":2803,"mtime":1609414566720,"results":"14","hashOfConfig":"10"},{"size":2740,"mtime":1609517365669,"results":"15","hashOfConfig":"10"},{"size":1258,"mtime":1609517989841,"results":"16","hashOfConfig":"10"},{"size":4800,"mtime":1609517164602,"results":"17","hashOfConfig":"10"},{"filePath":"18","messages":"19","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"ucih0b",{"filePath":"20","messages":"21","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"22","messages":"23","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"24"},{"filePath":"25","messages":"26","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"27","messages":"28","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"29","messages":"30","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"31","messages":"32","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"33","messages":"34","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/Users/dominic_kendrick/code/spotify-fairpay/src/reportWebVitals.js",[],"/Users/dominic_kendrick/code/spotify-fairpay/src/index.js",[],"/Users/dominic_kendrick/code/spotify-fairpay/src/spotify/api.ts",["35"],"import axios from \"axios\";\nimport qs from \"qs\";\nimport { sha256, bufferToBase64UrlEncoded, getRandomInt, makeid } from \"./utils\"\n\nexport const clientId = \"ad2aef8b86924e66941a6c4344c4bf8a\";\nexport const spotifyAuthDomain = \"https://accounts.spotify.com\";\nconst redirectUrl = `${window.location.protocol + \"//\" + window.location.host + \"/\"}auth-callback`;\nconst scopes = \"user-read-recently-played user-top-read\";\n\n\n\nexport const loginRedirect = async () => {\n  // Generate the code verifier and its base 64 encoded hash\n  const codeVerifier = makeid(getRandomInt(43, 128));\n  const hashed = await sha256(codeVerifier);\n  const codeChallenge = bufferToBase64UrlEncoded(hashed);\n  const state = makeid(12);\n\n  // Set the code verifier and state in local storage so we can check it later\n  sessionStorage.setItem(\"spotify-code-verifier\", codeVerifier);\n  sessionStorage.setItem(\"spotify-state\", state);\n\n  // construct the authentication url\n  const authURL = new URL(spotifyAuthDomain + \"/authorize\");\n\n  authURL.searchParams.append(\"response_type\", \"code\");\n  authURL.searchParams.append(\"client_id\", clientId);\n  authURL.searchParams.append(\"redirect_uri\", redirectUrl);\n  authURL.searchParams.append(\"scope\", scopes);\n  authURL.searchParams.append(\"state\", state);\n  authURL.searchParams.append(\"code_challenge\", codeChallenge);\n  authURL.searchParams.append(\"code_challenge_method\", \"S256\");\n\n  // open the spotify authentication page\n  window.location.href = authURL.toString();\n};\n\n\nexport const tokenExchange = async () => {\n  const params = new URL(window.location.href).searchParams;\n  const code = params.get(\"code\");\n  const state = params.get(\"state\");\n  // TODO: check state\n  const code_verifier = sessionStorage.getItem(\"spotify-code-verifier\");\n\n  const postBody = {\n    client_id: clientId,\n    grant_type: \"authorization_code\",\n    code: code,\n    redirect_uri: redirectUrl,\n    code_verifier: code_verifier,\n  };\n\n  const tokenUrl = spotifyAuthDomain + \"/api/token\";\n\n  console.log(\"token-verification\")\n  return axios\n    .post(tokenUrl, qs.stringify(postBody), {\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\n      },\n    })\n\n};\n\n\n\nexport const getSessionData = () => {\n  const sessionData = sessionStorage.getItem(\"spotify-session-data\");\n\n  if (sessionData) {\n    try {\n      return JSON.parse(sessionData);\n    } catch (e) {\n      console.log(\"failed to parse storage data\", e);\n    }\n  }\n};\n","/Users/dominic_kendrick/code/spotify-fairpay/src/App.tsx",[],"/Users/dominic_kendrick/code/spotify-fairpay/src/spotify/utils.ts",[],"/Users/dominic_kendrick/code/spotify-fairpay/src/spotify/ArtistChart.tsx",["36"],"/Users/dominic_kendrick/code/spotify-fairpay/src/spotify/ArtistLists.tsx",[],"/Users/dominic_kendrick/code/spotify-fairpay/src/spotify/ArtistsData.tsx",[],{"ruleId":"37","severity":1,"message":"38","line":42,"column":9,"nodeType":"39","messageId":"40","endLine":42,"endColumn":14},{"ruleId":"41","severity":1,"message":"42","line":65,"column":5,"nodeType":"43","endLine":65,"endColumn":7,"suggestions":"44"},"@typescript-eslint/no-unused-vars","'state' is assigned a value but never used.","Identifier","unusedVar","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'props'. Either include it or remove the dependency array.","ArrayExpression",["45"],{"desc":"46","fix":"47"},"Update the dependencies array to be: [props]",{"range":"48","text":"49"},[1966,1968],"[props]"]